<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Survey</title>
    <!-- Latest compiled and minified CSS & JS -->
    
    
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
            crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <link type="text/css" media="screen" href="/app/public/style.css">
</head>

<body>
    <div id="container">
        <h2>Survey Questions</h2>
            <hr>
            
            <h3><strong>About You</strong></h3>
            <h4>Name (Required)</h4>
            <input type="text" id="name" class="form-control" required>
            
            <h4>Link to Photo Image (Required)</h4>
            <input type="text" id="photo" class="form-control" required>
            
            <hr>




        <div class="select" id="selections">
            <h2>Question 1</h2>
            <span>Your mind is always buzzing with unexplored ideas and plans.</span>
            <select class="chosen-select" id="q1">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 2</h2>
            <span>Generally speaking, you rely more on your experience than your imagination.</span>
            <select class="chosen-select" id="q2">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <h2>Question 3</h2>
            <span>You find it easy to stay relaxed and focused even when there is some pressure.</span>
            <select class="chosen-select" id="q3">
                <option selected>Select an Option</option>
                <option value="1" class="selected">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 4</h2>
            <span>You rarely do something just out of sheer curiosity.</span>
            <select class="chosen-select" id="q4">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 5</h2>
            <span>People can rarely upset you.</span>
            <select class="chosen-select" id="q5">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 6</h2>
            <span>It is often difficult fo you to relate to other people's feelings.</span>
            <select class="chosen-select" id="q6">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 7</h2>
            <span>In a discussion, truth should be more important than people's sensitivities.</span>
            <select class="chosen-select" id="q7">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 8</h2>
            <span>You rarely get carried away by fantasies and ideas.</span>
            <select class="chosen-select" id="q8">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 9</h2>
            <span>You think that everyone's view should be respected regardless of whether they are supported by facts
                or not.</span>
            <select class="chosen-select" id="q9">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <h2>Question 10</h2>
            <span>You feel more energetic after spending time with a group of people.</span>
            <select class="chosen-select" id="q10">
                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">Submit</button>
        </div>


<!-- Modal -->
<div id="results-modal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
                <h2 class="modal-title"><strong>Best Match</strong></h2>
            </div>
            <div class="modal-body">
                <h2 id="match-name"></h2>
                <img id="match-img" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg"
                    alt="">
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>

        <script type="text/javascript">
            // Build out survey
            // Use jquery to grab the input values .$().val().trim()
            // wrap up all data in one object
            /*
            let userInfo = {
                name: $().val...  , 
             }
            */

            // make an ajax request to the back end route /api.friends

            //
                var config = {
                        ".chosen-select": {},
                        ".chosen-select-deselect": {
                            allow_single_deselect: true
                        },
                        ".chosen-select-no-single": {
                            disable_search_threshold: 10
                        },
                        ".chosen-select-no-results": {
                            no_results_text: "Oops, nothing found!"
                        },
                        ".chosen-select-width": {
                            width: "95%"
                        }
                    };
                // for (var selector in config) {
                //         $(selector).chosen(config[selector]);
                //     }


            $("#submit").on("click", function (event) {
                event.preventDefault()
                      // Form validation
                function validateForm() {
                    var isValid = true;
                    $(".form-control").each(function () {
                        if ($(this).val() === "") {
                            isValid = false;
                        }
                    });

                // var searchedFriend = $("#friend-search").val().trim();
                // searchedFriend = searchedFriend.replace(/\s+/g, "").toLowerCase();
                    
                    $(".chosen-select").each(function () {

                        if ($(this).val() === "") {
                            isValid = false;
                        }
                    });
                    return isValid;
                }

                // If all required fields are filled
                if (validateForm()) {
                    // Create an object for the user"s data
                    var userData = {
                        name: $("#name").val(),
                        photo: $("#photo").val(),
                        scores: [
                            $("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                        ]
                    };


                    // AJAX post the data to the friends API.
                    $.post("/api/friends", userData, function (data) {

                        // Grab the result from the AJAX post so that the best match's name and photo are displayed.
                        $("#match-name").text(data.name);
                        $("#match-img").attr("src", data.photo);

                        // Show the modal with the best match
                        $("#results-modal").modal("toggle");

                    });
                } else {
                    alert("Please fill out all fields before submitting!");
                }
            });


            //     $.get("/api/friends/" + searchedFriend, function (data) {
            //         console.log(data);
            //         if (data) {
            //             $("#stats").show();
            //             $("#name").text(data.name);
            //             $("#photo").text(data.photo);
            //             $("#scores").text(data.scores);
            //         }
            //         else {
            //             $("#name").text("You don't have a friend by that name.");
            //             $("#stats").hide();
            //         }

            //         var makeArray = function () {
            //             console.log()
            //             var form = document.getElementById("selections")
            //             var inputs = $("#selections").find(":selected")
            //             var input = ''
            //             var results = []

            //             for (var i = 0; i < inputs.length; i++) {
            //                 input = inputs[i]
            //                 results.push(input.text)
            //             }
            //             console.log(results)
            //         }
            //         makeArray()

            //         // var inputValues = $('.chosen-select').map(x => {
            //         //     console.log("hit")
            //         //     console.log(x)
            //         // }).toArray();
            //     });
            // });


        </script>

</body>